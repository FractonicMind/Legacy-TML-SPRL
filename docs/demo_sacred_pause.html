<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>‚è∏Ô∏è Sacred Pause ‚Äî Browser Demo (Safe Mode)</title>
<style>
  body { font-family: sans-serif; max-width: 720px; margin: auto; }
  textarea { width: 100%; height: 70px; }
  button { margin-top: 8px; padding: 6px 12px; font-size: 16px; }
  pre { background: #f4f4f4; padding: 10px; border-radius: 6px; }
</style>
</head>
<body>
<h1>‚è∏Ô∏è Sacred Pause ‚Äî Browser Demo (Safe Mode)</h1>
<p>Deny-by-default. Only vetted prompts may proceed. Risky prompts refuse. Sensitive or unclear prompts hold.</p>

<textarea id="prompt" placeholder="Ask me something..."></textarea><br>
<button id="run">Run</button>

<pre id="out"></pre>

<script>
// ======== Regex rules ========
const RX = {
  SELF_HARM: /\b(kill myself|suicide|end my life|hurt myself|overdose)\b/i
};

function isTaboo(p){
  const crimes = /\b(hack a bank|make a bomb|steal|murder|assassinate)\b/i;
  if (crimes.test(p)){
    return { category: "illegal_activity" };
  }
  return null;
}

function isAmbiguous(p){
  // crude ambiguity check ‚Äî too short or vague
  return p.length < 4 || /\b(this|that|it|thing)\b/i.test(p);
}

// ======== Sensitive-domain Hold ========
function needsExpertHold(p){
  const MED = /\b((what|which)\s+medicine|should\s+i\s+take|dos(e|age)|diagnos(e|is)|symptoms?|prescription|antibiotic|painkiller|ibuprofen|acetaminophen|tylenol|advil|naproxen|opioid|contraindication|side\s+effects?)\b/i;
  const LEGAL = /\b(should\s+i\s+sue|legal\s+advice|contract\s+issue|liability|cease\s+and\s+desist|immigration\s+status|asylum|copyright|trademark)\b/i;
  const FIN = /\b(invest(ment)?|buy\s+stock|crypto|option(s)?\s+strategy|retirement\s+plan|tax\s+advice|deduction|write[-\s]?off|capital\s+gains|which\s+fund)\b/i;
  const EMER = /\b(overdose|allergic\s+reaction|chest\s+pain|stroke\s+symptoms|difficulty\s+breathing|shock)\b/i;
  return MED.test(p) || LEGAL.test(p) || FIN.test(p) || EMER.test(p);
}

// ======== Whitelist facts ========
const WHITELIST = [
  { q: /\b(capital of japan)\b/i, a: "The capital of Japan is Tokyo." },
  { q: /\b(2\s*\+\s*2)\b/, a: "2 + 2 = 4." }
];

// ======== Decision logic ========
function decide(prompt){
  const p = (prompt || "").toLowerCase().trim();

  // 1) Self-harm ‚Üí Refuse
  if (RX.SELF_HARM.test(p)){
    return {
      state: "-1",
      triggers: ["ethical_risk"],
      checks: ["safety_policy"],
      answer: "I‚Äôm really sorry you‚Äôre feeling this way, but I can‚Äôt help with that. If you‚Äôre in danger, call local emergency services. You‚Äôre not alone‚Äîplease consider reaching out to someone you trust or a professional."
    };
  }

  // 2) Taboo / illegal ‚Üí Refuse
  const taboo = isTaboo(p);
  if (taboo){
    return { state: "-1", triggers: ["ethical_risk"], checks: [taboo.category], answer: "I must refuse for safety reasons." };
  }

  // 3) Sensitive domain ‚Üí Hold
  if (needsExpertHold(p)){
    return { state: "0", triggers: ["sensitive_domain"], checks: ["expert_review"], answer: "I should not give direct advice here. Please consult a qualified professional." };
  }

  // 4) Whitelist ‚Üí Proceed
  for (const rule of WHITELIST){
    if (rule.q.test(p)){
      return { state: "+1", triggers: ["light_fact_verify"], checks: ["factual_check"], answer: rule.a };
    }
  }

  // 5) Ambiguous ‚Üí Hold
  if (isAmbiguous(p)){
    return { state: "0", triggers: ["unknown_or_ambiguous"], checks: ["intent_audit"], answer: "I need clarification before proceeding." };
  }

  // 6) Default ‚Üí Proceed
  return {
    state: "+1",
    triggers: ["default_allow"],
    checks: ["factual_check"],
    answer: "Proceeding with a safe, helpful answer."
  };
}

// ======== UI glue ========
function badge(state){
  return ({"+1":"‚úÖ +1 Proceed","0":"üü° 0 Hold","-1":"‚ùå ‚àí1 Refuse"})[state] || "üü° 0 Hold";
}
function pause(ms){ return new Promise(r=>setTimeout(r,ms)); }

document.getElementById("run").onclick = async ()=>{
  const prompt = document.getElementById("prompt").value.trim();
  const out = document.getElementById("out");
  out.innerHTML = `‚è≥ Pausing to think‚Ä¶`;
  await pause(900);
  const d = decide(prompt);
  out.innerHTML = `
Why I paused: ${d.triggers.join(", ")}
Checks I ran: ${d.checks.join(", ")}
${badge(d.state)}
Output: ${d.answer}
`;
};
</script>

</body>
</html>
